// Code generated by goa v3.23.4, DO NOT EDIT.
//
// registry gRPC server types
//
// Command:
// $ goa gen goa.design/goa-ai/registry/design -o registry

package server

import (
	"unicode/utf8"

	registrypb "goa.design/goa-ai/registry/gen/grpc/registry/pb"
	registry "goa.design/goa-ai/registry/gen/registry"
	goa "goa.design/goa/v3/pkg"
)

// NewRegisterPayload builds the payload of the "Register" endpoint of the
// "registry" service from the gRPC request type.
func NewRegisterPayload(message *registrypb.RegisterRequest) *registry.RegisterPayload {
	v := &registry.RegisterPayload{
		Name:        message.Name,
		Description: message.Description,
	}
	if message.Version != nil {
		version := registry.SemVer(*message.Version)
		v.Version = &version
	}
	if message.Tags != nil {
		v.Tags = make([]string, len(message.Tags))
		for i, val := range message.Tags {
			v.Tags[i] = val
		}
	}
	if message.Tools != nil {
		v.Tools = make([]*registry.ToolSchema, len(message.Tools))
		for i, val := range message.Tools {
			v.Tools[i] = &registry.ToolSchema{
				Name:          val.Name,
				Description:   val.Description,
				PayloadSchema: val.PayloadSchema,
				ResultSchema:  val.ResultSchema,
				SidecarSchema: val.SidecarSchema,
			}
			if val.Tags != nil {
				v.Tools[i].Tags = make([]string, len(val.Tags))
				for j, val := range val.Tags {
					v.Tools[i].Tags[j] = val
				}
			}
		}
	}
	return v
}

// NewProtoRegisterResponse builds the gRPC response type from the result of
// the "Register" endpoint of the "registry" service.
func NewProtoRegisterResponse(result *registry.RegisterResult) *registrypb.RegisterResponse {
	message := &registrypb.RegisterResponse{
		StreamId:     result.StreamID,
		RegisteredAt: result.RegisteredAt,
	}
	return message
}

// NewUnregisterPayload builds the payload of the "Unregister" endpoint of the
// "registry" service from the gRPC request type.
func NewUnregisterPayload(message *registrypb.UnregisterRequest) *registry.UnregisterPayload {
	v := &registry.UnregisterPayload{
		Name: message.Name,
	}
	return v
}

// NewProtoUnregisterResponse builds the gRPC response type from the result of
// the "Unregister" endpoint of the "registry" service.
func NewProtoUnregisterResponse() *registrypb.UnregisterResponse {
	message := &registrypb.UnregisterResponse{}
	return message
}

// NewPongPayload builds the payload of the "Pong" endpoint of the "registry"
// service from the gRPC request type.
func NewPongPayload(message *registrypb.PongRequest) *registry.PongPayload {
	v := &registry.PongPayload{
		PingID:  message.PingId,
		Toolset: message.Toolset,
	}
	return v
}

// NewProtoPongResponse builds the gRPC response type from the result of the
// "Pong" endpoint of the "registry" service.
func NewProtoPongResponse() *registrypb.PongResponse {
	message := &registrypb.PongResponse{}
	return message
}

// NewListToolsetsPayload builds the payload of the "ListToolsets" endpoint of
// the "registry" service from the gRPC request type.
func NewListToolsetsPayload(message *registrypb.ListToolsetsRequest) *registry.ListToolsetsPayload {
	v := &registry.ListToolsetsPayload{}
	if message.Tags != nil {
		v.Tags = make([]string, len(message.Tags))
		for i, val := range message.Tags {
			v.Tags[i] = val
		}
	}
	return v
}

// NewProtoListToolsetsResponse builds the gRPC response type from the result
// of the "ListToolsets" endpoint of the "registry" service.
func NewProtoListToolsetsResponse(result *registry.ListToolsetsResult) *registrypb.ListToolsetsResponse {
	message := &registrypb.ListToolsetsResponse{}
	if result.Toolsets != nil {
		message.Toolsets = make([]*registrypb.ToolsetInfo, len(result.Toolsets))
		for i, val := range result.Toolsets {
			message.Toolsets[i] = &registrypb.ToolsetInfo{
				Name:         val.Name,
				Description:  val.Description,
				ToolCount:    int32(val.ToolCount),
				RegisteredAt: val.RegisteredAt,
			}
			if val.Version != nil {
				version := string(*val.Version)
				message.Toolsets[i].Version = &version
			}
			if val.Tags != nil {
				message.Toolsets[i].Tags = make([]string, len(val.Tags))
				for j, val := range val.Tags {
					message.Toolsets[i].Tags[j] = val
				}
			}
		}
	}
	return message
}

// NewGetToolsetPayload builds the payload of the "GetToolset" endpoint of the
// "registry" service from the gRPC request type.
func NewGetToolsetPayload(message *registrypb.GetToolsetRequest) *registry.GetToolsetPayload {
	v := &registry.GetToolsetPayload{
		Name: message.Name,
	}
	return v
}

// NewProtoGetToolsetResponse builds the gRPC response type from the result of
// the "GetToolset" endpoint of the "registry" service.
func NewProtoGetToolsetResponse(result *registry.Toolset) *registrypb.GetToolsetResponse {
	message := &registrypb.GetToolsetResponse{
		Name:         result.Name,
		Description:  result.Description,
		StreamId:     result.StreamID,
		RegisteredAt: result.RegisteredAt,
	}
	if result.Version != nil {
		version := string(*result.Version)
		message.Version = &version
	}
	if result.Tags != nil {
		message.Tags = make([]string, len(result.Tags))
		for i, val := range result.Tags {
			message.Tags[i] = val
		}
	}
	if result.Tools != nil {
		message.Tools = make([]*registrypb.ToolSchema, len(result.Tools))
		for i, val := range result.Tools {
			message.Tools[i] = &registrypb.ToolSchema{
				Name:          val.Name,
				Description:   val.Description,
				PayloadSchema: val.PayloadSchema,
				ResultSchema:  val.ResultSchema,
				SidecarSchema: val.SidecarSchema,
			}
			if val.Tags != nil {
				message.Tools[i].Tags = make([]string, len(val.Tags))
				for j, val := range val.Tags {
					message.Tools[i].Tags[j] = val
				}
			}
		}
	}
	return message
}

// NewSearchPayload builds the payload of the "Search" endpoint of the
// "registry" service from the gRPC request type.
func NewSearchPayload(message *registrypb.SearchRequest) *registry.SearchPayload {
	v := &registry.SearchPayload{
		Query: message.Query,
	}
	return v
}

// NewProtoSearchResponse builds the gRPC response type from the result of the
// "Search" endpoint of the "registry" service.
func NewProtoSearchResponse(result *registry.SearchResult) *registrypb.SearchResponse {
	message := &registrypb.SearchResponse{}
	if result.Toolsets != nil {
		message.Toolsets = make([]*registrypb.ToolsetInfo, len(result.Toolsets))
		for i, val := range result.Toolsets {
			message.Toolsets[i] = &registrypb.ToolsetInfo{
				Name:         val.Name,
				Description:  val.Description,
				ToolCount:    int32(val.ToolCount),
				RegisteredAt: val.RegisteredAt,
			}
			if val.Version != nil {
				version := string(*val.Version)
				message.Toolsets[i].Version = &version
			}
			if val.Tags != nil {
				message.Toolsets[i].Tags = make([]string, len(val.Tags))
				for j, val := range val.Tags {
					message.Toolsets[i].Tags[j] = val
				}
			}
		}
	}
	return message
}

// NewCallToolPayload builds the payload of the "CallTool" endpoint of the
// "registry" service from the gRPC request type.
func NewCallToolPayload(message *registrypb.CallToolRequest) *registry.CallToolPayload {
	v := &registry.CallToolPayload{
		Toolset:     message.Toolset,
		Tool:        message.Tool,
		PayloadJSON: message.PayloadJson,
	}
	if message.Meta != nil {
		v.Meta = protobufRegistrypbToolCallMetaToRegistryToolCallMeta(message.Meta)
	}
	return v
}

// NewProtoCallToolResponse builds the gRPC response type from the result of
// the "CallTool" endpoint of the "registry" service.
func NewProtoCallToolResponse(result *registry.CallToolResult) *registrypb.CallToolResponse {
	message := &registrypb.CallToolResponse{
		ToolUseId:      result.ToolUseID,
		ResultStreamId: result.ResultStreamID,
	}
	return message
}

// ValidateRegisterRequest runs the validations defined on RegisterRequest.
func ValidateRegisterRequest(message *registrypb.RegisterRequest) (err error) {
	if message.Tools == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("tools", "message"))
	}
	if utf8.RuneCountInString(message.Name) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.name", message.Name, utf8.RuneCountInString(message.Name), 1, true))
	}
	if utf8.RuneCountInString(message.Name) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.name", message.Name, utf8.RuneCountInString(message.Name), 256, false))
	}
	if message.Description != nil {
		if utf8.RuneCountInString(*message.Description) > 4096 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("message.description", *message.Description, utf8.RuneCountInString(*message.Description), 4096, false))
		}
	}
	if message.Version != nil {
		err = goa.MergeErrors(err, goa.ValidatePattern("message.version", string(*message.Version), "^v?\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9.]+)?$"))
	}
	for _, e := range message.Tools {
		if e != nil {
			if err2 := ValidateToolSchema(e); err2 != nil {
				err = goa.MergeErrors(err, err2)
			}
		}
	}
	return
}

// ValidateToolSchema runs the validations defined on ToolSchema.
func ValidateToolSchema(elem *registrypb.ToolSchema) (err error) {
	if utf8.RuneCountInString(elem.Name) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("elem.name", elem.Name, utf8.RuneCountInString(elem.Name), 1, true))
	}
	if utf8.RuneCountInString(elem.Name) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("elem.name", elem.Name, utf8.RuneCountInString(elem.Name), 256, false))
	}
	if len(elem.PayloadSchema) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("elem.payload_schema", elem.PayloadSchema, len(elem.PayloadSchema), 1, true))
	}
	if len(elem.ResultSchema) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("elem.result_schema", elem.ResultSchema, len(elem.ResultSchema), 1, true))
	}
	return
}

// ValidateUnregisterRequest runs the validations defined on UnregisterRequest.
func ValidateUnregisterRequest(message *registrypb.UnregisterRequest) (err error) {
	if utf8.RuneCountInString(message.Name) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.name", message.Name, utf8.RuneCountInString(message.Name), 1, true))
	}
	return
}

// ValidatePongRequest runs the validations defined on PongRequest.
func ValidatePongRequest(message *registrypb.PongRequest) (err error) {
	if utf8.RuneCountInString(message.PingId) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.ping_id", message.PingId, utf8.RuneCountInString(message.PingId), 1, true))
	}
	if utf8.RuneCountInString(message.PingId) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.ping_id", message.PingId, utf8.RuneCountInString(message.PingId), 256, false))
	}
	if utf8.RuneCountInString(message.Toolset) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.toolset", message.Toolset, utf8.RuneCountInString(message.Toolset), 1, true))
	}
	if utf8.RuneCountInString(message.Toolset) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.toolset", message.Toolset, utf8.RuneCountInString(message.Toolset), 256, false))
	}
	return
}

// ValidateGetToolsetRequest runs the validations defined on GetToolsetRequest.
func ValidateGetToolsetRequest(message *registrypb.GetToolsetRequest) (err error) {
	if utf8.RuneCountInString(message.Name) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.name", message.Name, utf8.RuneCountInString(message.Name), 1, true))
	}
	return
}

// ValidateSearchRequest runs the validations defined on SearchRequest.
func ValidateSearchRequest(message *registrypb.SearchRequest) (err error) {
	if utf8.RuneCountInString(message.Query) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.query", message.Query, utf8.RuneCountInString(message.Query), 1, true))
	}
	if utf8.RuneCountInString(message.Query) > 1024 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.query", message.Query, utf8.RuneCountInString(message.Query), 1024, false))
	}
	return
}

// ValidateCallToolRequest runs the validations defined on CallToolRequest.
func ValidateCallToolRequest(message *registrypb.CallToolRequest) (err error) {
	if message.Meta == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("meta", "message"))
	}
	if utf8.RuneCountInString(message.Toolset) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.toolset", message.Toolset, utf8.RuneCountInString(message.Toolset), 1, true))
	}
	if utf8.RuneCountInString(message.Toolset) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.toolset", message.Toolset, utf8.RuneCountInString(message.Toolset), 256, false))
	}
	if utf8.RuneCountInString(message.Tool) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.tool", message.Tool, utf8.RuneCountInString(message.Tool), 1, true))
	}
	if utf8.RuneCountInString(message.Tool) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.tool", message.Tool, utf8.RuneCountInString(message.Tool), 256, false))
	}
	if len(message.PayloadJson) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.payload_json", message.PayloadJson, len(message.PayloadJson), 1, true))
	}
	if message.Meta != nil {
		if err2 := ValidateToolCallMeta(message.Meta); err2 != nil {
			err = goa.MergeErrors(err, err2)
		}
	}
	return
}

// ValidateToolCallMeta runs the validations defined on ToolCallMeta.
func ValidateToolCallMeta(meta *registrypb.ToolCallMeta) (err error) {
	if utf8.RuneCountInString(meta.RunId) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("meta.run_id", meta.RunId, utf8.RuneCountInString(meta.RunId), 1, true))
	}
	if utf8.RuneCountInString(meta.SessionId) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("meta.session_id", meta.SessionId, utf8.RuneCountInString(meta.SessionId), 1, true))
	}
	if meta.TurnId != nil {
		if utf8.RuneCountInString(*meta.TurnId) < 1 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("meta.turn_id", *meta.TurnId, utf8.RuneCountInString(*meta.TurnId), 1, true))
		}
	}
	if meta.ToolCallId != nil {
		if utf8.RuneCountInString(*meta.ToolCallId) < 1 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("meta.tool_call_id", *meta.ToolCallId, utf8.RuneCountInString(*meta.ToolCallId), 1, true))
		}
	}
	if meta.ParentToolCallId != nil {
		if utf8.RuneCountInString(*meta.ParentToolCallId) < 1 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("meta.parent_tool_call_id", *meta.ParentToolCallId, utf8.RuneCountInString(*meta.ParentToolCallId), 1, true))
		}
	}
	return
}

// protobufRegistrypbToolCallMetaToRegistryToolCallMeta builds a value of type
// *registry.ToolCallMeta from a value of type *registrypb.ToolCallMeta.
func protobufRegistrypbToolCallMetaToRegistryToolCallMeta(v *registrypb.ToolCallMeta) *registry.ToolCallMeta {
	res := &registry.ToolCallMeta{
		RunID:            v.RunId,
		SessionID:        v.SessionId,
		TurnID:           v.TurnId,
		ToolCallID:       v.ToolCallId,
		ParentToolCallID: v.ParentToolCallId,
	}

	return res
}

// svcRegistryToolCallMetaToRegistrypbToolCallMeta builds a value of type
// *registrypb.ToolCallMeta from a value of type *registry.ToolCallMeta.
func svcRegistryToolCallMetaToRegistrypbToolCallMeta(v *registry.ToolCallMeta) *registrypb.ToolCallMeta {
	res := &registrypb.ToolCallMeta{
		RunId:            v.RunID,
		SessionId:        v.SessionID,
		TurnId:           v.TurnID,
		ToolCallId:       v.ToolCallID,
		ParentToolCallId: v.ParentToolCallID,
	}

	return res
}

// Code generated by goa v3.23.4, DO NOT EDIT.
//
// registry gRPC client types
//
// Command:
// $ goa gen goa.design/goa-ai/registry/design -o registry

package client

import (
	"unicode/utf8"

	registrypb "goa.design/goa-ai/registry/gen/grpc/registry/pb"
	registry "goa.design/goa-ai/registry/gen/registry"
	goa "goa.design/goa/v3/pkg"
)

// NewProtoRegisterRequest builds the gRPC request type from the payload of the
// "Register" endpoint of the "registry" service.
func NewProtoRegisterRequest(payload *registry.RegisterPayload) *registrypb.RegisterRequest {
	message := &registrypb.RegisterRequest{
		Name:        payload.Name,
		Description: payload.Description,
	}
	if payload.Version != nil {
		version := string(*payload.Version)
		message.Version = &version
	}
	if payload.Tags != nil {
		message.Tags = make([]string, len(payload.Tags))
		for i, val := range payload.Tags {
			message.Tags[i] = val
		}
	}
	if payload.Tools != nil {
		message.Tools = make([]*registrypb.ToolSchema, len(payload.Tools))
		for i, val := range payload.Tools {
			message.Tools[i] = &registrypb.ToolSchema{
				Name:          val.Name,
				Description:   val.Description,
				PayloadSchema: val.PayloadSchema,
				ResultSchema:  val.ResultSchema,
				SidecarSchema: val.SidecarSchema,
			}
			if val.Tags != nil {
				message.Tools[i].Tags = make([]string, len(val.Tags))
				for j, val := range val.Tags {
					message.Tools[i].Tags[j] = val
				}
			}
		}
	}
	return message
}

// NewRegisterResult builds the result type of the "Register" endpoint of the
// "registry" service from the gRPC response type.
func NewRegisterResult(message *registrypb.RegisterResponse) *registry.RegisterResult {
	result := &registry.RegisterResult{
		StreamID:     message.StreamId,
		RegisteredAt: message.RegisteredAt,
	}
	return result
}

// NewProtoUnregisterRequest builds the gRPC request type from the payload of
// the "Unregister" endpoint of the "registry" service.
func NewProtoUnregisterRequest(payload *registry.UnregisterPayload) *registrypb.UnregisterRequest {
	message := &registrypb.UnregisterRequest{
		Name: payload.Name,
	}
	return message
}

// NewProtoPongRequest builds the gRPC request type from the payload of the
// "Pong" endpoint of the "registry" service.
func NewProtoPongRequest(payload *registry.PongPayload) *registrypb.PongRequest {
	message := &registrypb.PongRequest{
		PingId:  payload.PingID,
		Toolset: payload.Toolset,
	}
	return message
}

// NewProtoListToolsetsRequest builds the gRPC request type from the payload of
// the "ListToolsets" endpoint of the "registry" service.
func NewProtoListToolsetsRequest(payload *registry.ListToolsetsPayload) *registrypb.ListToolsetsRequest {
	message := &registrypb.ListToolsetsRequest{}
	if payload.Tags != nil {
		message.Tags = make([]string, len(payload.Tags))
		for i, val := range payload.Tags {
			message.Tags[i] = val
		}
	}
	return message
}

// NewListToolsetsResult builds the result type of the "ListToolsets" endpoint
// of the "registry" service from the gRPC response type.
func NewListToolsetsResult(message *registrypb.ListToolsetsResponse) *registry.ListToolsetsResult {
	result := &registry.ListToolsetsResult{}
	if message.Toolsets != nil {
		result.Toolsets = make([]*registry.ToolsetInfo, len(message.Toolsets))
		for i, val := range message.Toolsets {
			result.Toolsets[i] = &registry.ToolsetInfo{
				Name:         val.Name,
				Description:  val.Description,
				ToolCount:    int(val.ToolCount),
				RegisteredAt: val.RegisteredAt,
			}
			if val.Version != nil {
				version := registry.SemVer(*val.Version)
				result.Toolsets[i].Version = &version
			}
			if val.Tags != nil {
				result.Toolsets[i].Tags = make([]string, len(val.Tags))
				for j, val := range val.Tags {
					result.Toolsets[i].Tags[j] = val
				}
			}
		}
	}
	return result
}

// NewProtoGetToolsetRequest builds the gRPC request type from the payload of
// the "GetToolset" endpoint of the "registry" service.
func NewProtoGetToolsetRequest(payload *registry.GetToolsetPayload) *registrypb.GetToolsetRequest {
	message := &registrypb.GetToolsetRequest{
		Name: payload.Name,
	}
	return message
}

// NewGetToolsetResult builds the result type of the "GetToolset" endpoint of
// the "registry" service from the gRPC response type.
func NewGetToolsetResult(message *registrypb.GetToolsetResponse) *registry.Toolset {
	result := &registry.Toolset{
		Name:         message.Name,
		Description:  message.Description,
		StreamID:     message.StreamId,
		RegisteredAt: message.RegisteredAt,
	}
	if message.Version != nil {
		version := registry.SemVer(*message.Version)
		result.Version = &version
	}
	if message.Tags != nil {
		result.Tags = make([]string, len(message.Tags))
		for i, val := range message.Tags {
			result.Tags[i] = val
		}
	}
	if message.Tools != nil {
		result.Tools = make([]*registry.ToolSchema, len(message.Tools))
		for i, val := range message.Tools {
			result.Tools[i] = &registry.ToolSchema{
				Name:          val.Name,
				Description:   val.Description,
				PayloadSchema: val.PayloadSchema,
				ResultSchema:  val.ResultSchema,
				SidecarSchema: val.SidecarSchema,
			}
			if val.Tags != nil {
				result.Tools[i].Tags = make([]string, len(val.Tags))
				for j, val := range val.Tags {
					result.Tools[i].Tags[j] = val
				}
			}
		}
	}
	return result
}

// NewProtoSearchRequest builds the gRPC request type from the payload of the
// "Search" endpoint of the "registry" service.
func NewProtoSearchRequest(payload *registry.SearchPayload) *registrypb.SearchRequest {
	message := &registrypb.SearchRequest{
		Query: payload.Query,
	}
	return message
}

// NewSearchResult builds the result type of the "Search" endpoint of the
// "registry" service from the gRPC response type.
func NewSearchResult(message *registrypb.SearchResponse) *registry.SearchResult {
	result := &registry.SearchResult{}
	if message.Toolsets != nil {
		result.Toolsets = make([]*registry.ToolsetInfo, len(message.Toolsets))
		for i, val := range message.Toolsets {
			result.Toolsets[i] = &registry.ToolsetInfo{
				Name:         val.Name,
				Description:  val.Description,
				ToolCount:    int(val.ToolCount),
				RegisteredAt: val.RegisteredAt,
			}
			if val.Version != nil {
				version := registry.SemVer(*val.Version)
				result.Toolsets[i].Version = &version
			}
			if val.Tags != nil {
				result.Toolsets[i].Tags = make([]string, len(val.Tags))
				for j, val := range val.Tags {
					result.Toolsets[i].Tags[j] = val
				}
			}
		}
	}
	return result
}

// NewProtoCallToolRequest builds the gRPC request type from the payload of the
// "CallTool" endpoint of the "registry" service.
func NewProtoCallToolRequest(payload *registry.CallToolPayload) *registrypb.CallToolRequest {
	message := &registrypb.CallToolRequest{
		Toolset:     payload.Toolset,
		Tool:        payload.Tool,
		PayloadJson: payload.PayloadJSON,
	}
	if payload.Meta != nil {
		message.Meta = svcRegistryToolCallMetaToRegistrypbToolCallMeta(payload.Meta)
	}
	return message
}

// NewCallToolResult builds the result type of the "CallTool" endpoint of the
// "registry" service from the gRPC response type.
func NewCallToolResult(message *registrypb.CallToolResponse) *registry.CallToolResult {
	result := &registry.CallToolResult{
		ToolUseID:      message.ToolUseId,
		ResultStreamID: message.ResultStreamId,
	}
	return result
}

// ValidateToolSchema runs the validations defined on ToolSchema.
func ValidateToolSchema(elem *registrypb.ToolSchema) (err error) {
	if utf8.RuneCountInString(elem.Name) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("elem.name", elem.Name, utf8.RuneCountInString(elem.Name), 1, true))
	}
	if utf8.RuneCountInString(elem.Name) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("elem.name", elem.Name, utf8.RuneCountInString(elem.Name), 256, false))
	}
	if len(elem.PayloadSchema) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("elem.payload_schema", elem.PayloadSchema, len(elem.PayloadSchema), 1, true))
	}
	if len(elem.ResultSchema) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("elem.result_schema", elem.ResultSchema, len(elem.ResultSchema), 1, true))
	}
	return
}

// ValidateRegisterResponse runs the validations defined on RegisterResponse.
func ValidateRegisterResponse(message *registrypb.RegisterResponse) (err error) {
	if utf8.RuneCountInString(message.StreamId) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.stream_id", message.StreamId, utf8.RuneCountInString(message.StreamId), 1, true))
	}
	err = goa.MergeErrors(err, goa.ValidateFormat("message.registered_at", message.RegisteredAt, goa.FormatDateTime))
	return
}

// ValidateListToolsetsResponse runs the validations defined on
// ListToolsetsResponse.
func ValidateListToolsetsResponse(message *registrypb.ListToolsetsResponse) (err error) {
	if message.Toolsets == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("toolsets", "message"))
	}
	for _, e := range message.Toolsets {
		if e != nil {
			if err2 := ValidateToolsetInfo(e); err2 != nil {
				err = goa.MergeErrors(err, err2)
			}
		}
	}
	return
}

// ValidateToolsetInfo runs the validations defined on ToolsetInfo.
func ValidateToolsetInfo(elem *registrypb.ToolsetInfo) (err error) {
	if utf8.RuneCountInString(elem.Name) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("elem.name", elem.Name, utf8.RuneCountInString(elem.Name), 1, true))
	}
	if utf8.RuneCountInString(elem.Name) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("elem.name", elem.Name, utf8.RuneCountInString(elem.Name), 256, false))
	}
	if elem.Version != nil {
		err = goa.MergeErrors(err, goa.ValidatePattern("elem.version", string(*elem.Version), "^v?\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9.]+)?$"))
	}
	if elem.ToolCount < 0 {
		err = goa.MergeErrors(err, goa.InvalidRangeError("elem.tool_count", elem.ToolCount, 0, true))
	}
	err = goa.MergeErrors(err, goa.ValidateFormat("elem.registered_at", elem.RegisteredAt, goa.FormatDateTime))
	return
}

// ValidateGetToolsetResponse runs the validations defined on
// GetToolsetResponse.
func ValidateGetToolsetResponse(message *registrypb.GetToolsetResponse) (err error) {
	if message.Tools == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("tools", "message"))
	}
	if utf8.RuneCountInString(message.Name) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.name", message.Name, utf8.RuneCountInString(message.Name), 1, true))
	}
	if utf8.RuneCountInString(message.Name) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.name", message.Name, utf8.RuneCountInString(message.Name), 256, false))
	}
	if message.Version != nil {
		err = goa.MergeErrors(err, goa.ValidatePattern("message.version", string(*message.Version), "^v?\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9.]+)?$"))
	}
	for _, e := range message.Tools {
		if e != nil {
			if err2 := ValidateToolSchema(e); err2 != nil {
				err = goa.MergeErrors(err, err2)
			}
		}
	}
	if utf8.RuneCountInString(message.StreamId) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.stream_id", message.StreamId, utf8.RuneCountInString(message.StreamId), 1, true))
	}
	err = goa.MergeErrors(err, goa.ValidateFormat("message.registered_at", message.RegisteredAt, goa.FormatDateTime))
	return
}

// ValidateSearchResponse runs the validations defined on SearchResponse.
func ValidateSearchResponse(message *registrypb.SearchResponse) (err error) {
	if message.Toolsets == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("toolsets", "message"))
	}
	for _, e := range message.Toolsets {
		if e != nil {
			if err2 := ValidateToolsetInfo(e); err2 != nil {
				err = goa.MergeErrors(err, err2)
			}
		}
	}
	return
}

// ValidateCallToolResponse runs the validations defined on CallToolResponse.
func ValidateCallToolResponse(message *registrypb.CallToolResponse) (err error) {
	if utf8.RuneCountInString(message.ToolUseId) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.tool_use_id", message.ToolUseId, utf8.RuneCountInString(message.ToolUseId), 1, true))
	}
	if utf8.RuneCountInString(message.ToolUseId) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.tool_use_id", message.ToolUseId, utf8.RuneCountInString(message.ToolUseId), 256, false))
	}
	if utf8.RuneCountInString(message.ResultStreamId) < 1 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.result_stream_id", message.ResultStreamId, utf8.RuneCountInString(message.ResultStreamId), 1, true))
	}
	if utf8.RuneCountInString(message.ResultStreamId) > 256 {
		err = goa.MergeErrors(err, goa.InvalidLengthError("message.result_stream_id", message.ResultStreamId, utf8.RuneCountInString(message.ResultStreamId), 256, false))
	}
	return
}

// protobufRegistrypbToolCallMetaToRegistryToolCallMeta builds a value of type
// *registry.ToolCallMeta from a value of type *registrypb.ToolCallMeta.
func protobufRegistrypbToolCallMetaToRegistryToolCallMeta(v *registrypb.ToolCallMeta) *registry.ToolCallMeta {
	res := &registry.ToolCallMeta{
		RunID:            v.RunId,
		SessionID:        v.SessionId,
		TurnID:           v.TurnId,
		ToolCallID:       v.ToolCallId,
		ParentToolCallID: v.ParentToolCallId,
	}

	return res
}

// svcRegistryToolCallMetaToRegistrypbToolCallMeta builds a value of type
// *registrypb.ToolCallMeta from a value of type *registry.ToolCallMeta.
func svcRegistryToolCallMetaToRegistrypbToolCallMeta(v *registry.ToolCallMeta) *registrypb.ToolCallMeta {
	res := &registrypb.ToolCallMeta{
		RunId:            v.RunID,
		SessionId:        v.SessionID,
		TurnId:           v.TurnID,
		ToolCallId:       v.ToolCallID,
		ParentToolCallId: v.ParentToolCallID,
	}

	return res
}

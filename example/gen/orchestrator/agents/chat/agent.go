// Code generated by goa v3.22.6, DO NOT EDIT.
//
// ChatAgent implementation
//
// Command:
// $ goa gen example.com/assistant/design

package chat

import (
	"context"
	"errors"
	"strings"

	"goa.design/goa-ai/runtime/agents/engine"
	"goa.design/goa-ai/runtime/agents/planner"
	runtime "goa.design/goa-ai/runtime/agents/runtime"
)

// ChatAgent wraps the planner implementation for agent "chat".
type ChatAgent struct {
	Planner planner.Planner
}

// NewChatAgent validates the configuration and constructs a ChatAgent.
func NewChatAgent(cfg ChatAgentConfig) (*ChatAgent, error) {
	if err := cfg.Validate(); err != nil {
		return nil, err
	}
	return &ChatAgent{Planner: cfg.Planner}, nil
}

// Run invokes this agent using the provided runtime and messages.
// sessionID is required and is applied via runtime.WithSessionID.
func Run(ctx context.Context, rt *runtime.Runtime, sessionID string, messages []planner.AgentMessage, opts ...runtime.RunOption) (runtime.RunOutput, error) {
	if strings.TrimSpace(sessionID) == "" {
		return runtime.RunOutput{}, errors.New("session id is required")
	}
	opts = append(opts, runtime.WithSessionID(sessionID))
	return rt.RunAgent(ctx, "orchestrator.chat", messages, opts...)
}

// Start begins execution of this agent and returns a workflow handle.
// sessionID is required and is applied via runtime.WithSessionID.
func Start(ctx context.Context, rt *runtime.Runtime, sessionID string, messages []planner.AgentMessage, opts ...runtime.RunOption) (engine.WorkflowHandle, error) {
	if strings.TrimSpace(sessionID) == "" {
		return nil, errors.New("session id is required")
	}
	opts = append(opts, runtime.WithSessionID(sessionID))
	return rt.StartAgent(ctx, "orchestrator.chat", messages, opts...)
}

// Code generated by goa v3.22.6, DO NOT EDIT.
//
// orchestrator service
//
// Command:
// $ goa gen example.com/assistant/design

package orchestrator

import (
	"context"
)

// Agent service consuming the assistant MCP toolset
type Service interface {
	// Invoke the chat agent
	Run(context.Context, *AgentRunPayload, RunServerStream) (err error)
}

// APIName is the name of the API as defined in the design.
const APIName = "assistant"

// APIVersion is the version of the API as defined in the design.
const APIVersion = "1.0"

// ServiceName is the name of the service as defined in the design. This is the
// same value that is set in the endpoint request contexts under the ServiceKey
// key.
const ServiceName = "orchestrator"

// MethodNames lists the service method names as defined in the design. These
// are the same values that are set in the endpoint request contexts under the
// MethodKey key.
var MethodNames = [1]string{"run"}

// RunEvent is the interface implemented by the result type for the run method.
type RunEvent interface {
	isRunEvent()
}

// isRunEvent implements the RunEvent interface.
func (*AgentRunChunk) isRunEvent() {}

// RunServerStream allows streaming instances of *AgentRunChunk over SSE.
type RunServerStream interface {
	// Send streams JSON-RPC notifications with "AgentRunChunk". Notifications do
	// not expect a response.
	// IMPORTANT: Send only sends JSON-RPC notifications. Use SendAndClose to send
	// a final response.
	Send(ctx context.Context, event RunEvent) error
	// SendAndClose sends a final response with "AgentRunChunk" and closes the
	// stream.
	// The result will be sent as a JSON-RPC response with the original request ID.
	// If the result has an ID field populated, that ID will be used instead of the
	// request ID.
	SendAndClose(ctx context.Context, event RunEvent) error
	// SendError sends a JSON-RPC error response.
	SendError(ctx context.Context, id string, err error) error
}

// RunClientStream allows streaming instances of *AgentRunChunk to the client.
type RunClientStream interface {
	// Recv reads instances of "AgentRunChunk" from the stream.
	Recv() (*AgentRunChunk, error)
	// RecvWithContext reads instances of "AgentRunChunk" from the stream with
	// context.
	RecvWithContext(context.Context) (*AgentRunChunk, error)
}

// Stream defines the interface for managing an SSE streaming connection in the
// orchestrator server. It allows sending notifications and final responses.
// This interface is used by the service to interact with clients over SSE
// using JSON-RPC.
type Stream interface {
	// Send sends an event (notification or response) to the client.
	// For notifications, the result should not have an ID field.
	// For responses, the result must have an ID field.
	// Accepted types: *AgentRunChunk
	Send(ctx context.Context, event Event) error
}

// Event is the interface implemented by all result types that can be sent via
// the orchestrator Stream.
type Event interface {
	isorchestratorEvent()
}

// isorchestratorEvent implements the Event interface.
func (*AgentRunChunk) isorchestratorEvent() {}

// Single conversational message in the agent transcript.
type AgentMessage struct {
	// Role that produced the message
	Role string
	// Message content
	Content string
	// Optional structured metadata attached to the message
	Meta map[string]any
}

// AgentRunChunk is the result type of the orchestrator service run method.
type AgentRunChunk struct {
	// Kind of chunk being delivered
	Type string
	// Assistant message fragment.
	Message *string
	// Tool call scheduling notification.
	ToolCall *AgentToolCallChunk
	// Tool result payload notification.
	ToolResult *AgentToolResultChunk
	// Run status update.
	Status *AgentRunStatusChunk
}

// AgentRunPayload is the payload type of the orchestrator service run method.
type AgentRunPayload struct {
	// Agent identifier to invoke (optional when bound to a single agent)
	AgentID *string
	// Caller-provided run identifier
	RunID *string
	// Session identifier used for grouping runs
	SessionID *string
	// Turn identifier associated with the run
	TurnID *string
	// Complete conversation history supplied to the agent
	Messages []*AgentMessage
	// Caller-supplied labels forwarded to the runtime
	Labels map[string]string
	// Arbitrary metadata forwarded to the runtime
	Metadata map[string]any
}

// Run status change emitted during streaming.
type AgentRunStatusChunk struct {
	// Current run state
	State string
	// Optional status annotation
	Message *string
}

// Chunk describing a scheduled tool call.
type AgentToolCallChunk struct {
	// Tool call identifier
	ID string
	// Tool name
	Name string
	// Payload submitted to the tool
	Payload any
}

// Structured tool error chain captured during execution.
type AgentToolError struct {
	// Human-readable error summary
	Message *string
	// Nested cause describing the underlying failure
	Cause *AgentToolError
}

// Chunk containing the result of a tool call.
type AgentToolResultChunk struct {
	// Tool call identifier
	ID string
	// Decoded tool result payload
	Result any
	// Tool error, when the call failed
	Error *AgentToolError
}

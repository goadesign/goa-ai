# A2A Skills Test Scenarios
# Tests the skill invocation through A2A protocol

scenarios:
  # Echo Skill
  - name: skill_echo_basic
    defaults:
      client: jsonrpc.a2a_test_agent
    steps:
      - name: invoke_echo
        op: TasksSend
        input:
          id: "skill-echo-001"
          message:
            role: "user"
            parts:
              - type: "data"
                data:
                  skill: "test_tools.echo"
                  arguments:
                    message: "Hello, World!"
        expect:
          status: success
          result:
            id: "skill-echo-001"
            status:
              state: "completed"

  # Add Numbers Skill
  - name: skill_add_numbers
    defaults:
      client: jsonrpc.a2a_test_agent
    steps:
      - name: invoke_add
        op: TasksSend
        input:
          id: "skill-add-001"
          message:
            role: "user"
            parts:
              - type: "data"
                data:
                  skill: "test_tools.add_numbers"
                  arguments:
                    a: 5
                    b: 3
        expect:
          status: success
          result:
            id: "skill-add-001"
            status:
              state: "completed"

  # Process Data Skill - JSON Format
  - name: skill_process_data_json
    defaults:
      client: jsonrpc.a2a_test_agent
    steps:
      - name: invoke_process_json
        op: TasksSend
        input:
          id: "skill-process-001"
          message:
            role: "user"
            parts:
              - type: "data"
                data:
                  skill: "test_tools.process_data"
                  arguments:
                    items: ["item1", "item2", "item3"]
                    format: "json"
        expect:
          status: success
          result:
            id: "skill-process-001"
            status:
              state: "completed"

  # Process Data Skill - Text Format
  - name: skill_process_data_text
    defaults:
      client: jsonrpc.a2a_test_agent
    steps:
      - name: invoke_process_text
        op: TasksSend
        input:
          id: "skill-process-002"
          message:
            role: "user"
            parts:
              - type: "data"
                data:
                  skill: "test_tools.process_data"
                  arguments:
                    items: ["hello", "world"]
                    format: "text"
        expect:
          status: success
          result:
            id: "skill-process-002"
            status:
              state: "completed"

  # Process Data Skill - CSV Format
  - name: skill_process_data_csv
    defaults:
      client: jsonrpc.a2a_test_agent
    steps:
      - name: invoke_process_csv
        op: TasksSend
        input:
          id: "skill-process-003"
          message:
            role: "user"
            parts:
              - type: "data"
                data:
                  skill: "test_tools.process_data"
                  arguments:
                    items: ["a", "b"]
                    format: "csv"
        expect:
          status: success
          result:
            id: "skill-process-003"
            status:
              state: "completed"

  # Validate Input Skill - Valid Input
  - name: skill_validate_input_valid
    defaults:
      client: jsonrpc.a2a_test_agent
    steps:
      - name: invoke_validate_valid
        op: TasksSend
        input:
          id: "skill-validate-001"
          message:
            role: "user"
            parts:
              - type: "data"
                data:
                  skill: "test_tools.validate_input"
                  arguments:
                    value: "test@example.com"
                    pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
        expect:
          status: success
          result:
            id: "skill-validate-001"
            status:
              state: "completed"

  # Validate Input Skill - Invalid Input
  - name: skill_validate_input_invalid
    defaults:
      client: jsonrpc.a2a_test_agent
    steps:
      - name: invoke_validate_invalid
        op: TasksSend
        input:
          id: "skill-validate-002"
          message:
            role: "user"
            parts:
              - type: "data"
                data:
                  skill: "test_tools.validate_input"
                  arguments:
                    value: "not-an-email"
                    pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
        expect:
          status: success
          result:
            id: "skill-validate-002"
            status:
              state: "completed"

  # Skill with Missing Required Arguments
  - name: skill_missing_required_args
    defaults:
      client: jsonrpc.a2a_test_agent
    steps:
      - name: invoke_missing_args
        op: TasksSend
        input:
          id: "skill-error-001"
          message:
            role: "user"
            parts:
              - type: "data"
                data:
                  skill: "test_tools.add_numbers"
                  arguments:
                    a: 5
                    # missing 'b'
        expect:
          status: success
          result:
            id: "skill-error-001"
            status:
              state: "completed"

  # Skill with Invalid Enum Value
  - name: skill_invalid_enum
    defaults:
      client: jsonrpc.a2a_test_agent
    steps:
      - name: invoke_invalid_enum
        op: TasksSend
        input:
          id: "skill-error-002"
          message:
            role: "user"
            parts:
              - type: "data"
                data:
                  skill: "test_tools.process_data"
                  arguments:
                    items: ["a"]
                    format: "invalid_format"
        expect:
          status: success
          result:
            id: "skill-error-002"
            status:
              state: "completed"

  # Streaming Skill Invocation
  - name: skill_streaming
    defaults:
      client: jsonrpc.a2a_test_agent
    steps:
      - name: invoke_streaming
        op: TasksSendSubscribe
        headers:
          Accept: text/event-stream
        input:
          id: "skill-stream-001"
          message:
            role: "user"
            parts:
              - type: "data"
                data:
                  skill: "test_tools.echo"
                  arguments:
                    message: "Stream this"
        stream_expect:
          min_events: 2
          events:
            - event: status
              data:
                taskId: "skill-stream-001"
